{"version":3,"file":"index.iife.min.js","sources":["../modules/search-box/index.js"],"sourcesContent":["import './style.css';\r\n\r\nfunction wrap(el, wrapper) {\r\n    el.parentNode.insertBefore(wrapper, el);\r\n    wrapper.appendChild(el);\r\n}\r\n\r\nlet active_el = null;\r\n\r\nexport default class SearchBox {\r\n    constructor(inputId, items) {\r\n        this.handlers = [];\r\n        this.container = document.createElement('div');\r\n        this.container.classList.add('search-box-container');\r\n        this.inputElement = document.getElementById(inputId);\r\n        wrap(this.inputElement, this.container);\r\n        this.items = items;\r\n        this.resultsContainer = this.createResultsContainer();\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        if (!this.inputElement) {\r\n            console.error(`Input element with id ${this.inputElement.id} not found.`);\r\n            return;\r\n        }\r\n\r\n        if (Array.isArray(this.items)) {\r\n            this.items = [...new Set(this.items)];\r\n            this.items.sort();\r\n        }\r\n\r\n        this.container.querySelector('.search-box-results').addEventListener('mousemove', evt => {\r\n            let el = document.elementFromPoint(evt.clientX, evt.clientY);\r\n\r\n            if (el.matches('.search-box-result-item') && (el !== active_el)) {\r\n                let current_active = el.parentElement.querySelector('.active');\r\n\r\n                if (current_active) {\r\n                    current_active.classList.remove('active');\r\n                }\r\n\r\n                active_el = el;\r\n                active_el.classList.add('active');\r\n            }\r\n        })\r\n\r\n        this.container.addEventListener('click', evt => {\r\n            let el = evt.target;\r\n\r\n            if (el.matches('.search-box-result-item')) {\r\n                evt.preventDefault();\r\n\r\n                let a = el.querySelector('a');\r\n                let text = a.innerText;\r\n\r\n                this.container.querySelector('.search-box-results')?.classList.remove('show');\r\n                this.inputElement.value = text;\r\n\r\n                if (typeof this.handlers['search'] == 'function') {\r\n                    let search_text = this.inputElement.value.trim();\r\n\r\n                    if (search_text != '') {\r\n                        this.handlers['search'](search_text);\r\n                    }\r\n                }\r\n            }\r\n        })\r\n\r\n        this.inputElement.addEventListener('input', (evt) => {\r\n            this.performSearch()\r\n        })\r\n\r\n        this.inputElement.addEventListener('keydown', (evt) => {\r\n            let key = evt.key;\r\n            let el;\r\n\r\n            switch (key) {\r\n                case 'Tab':\r\n                    evt.preventDefault();\r\n                    el = this.container.querySelector('.search-box-results.show');\r\n\r\n                    if (el) {\r\n                        let active_item = el.querySelector('.search-box-result-item.active');\r\n\r\n                        if (!active_item) {\r\n                            el.querySelector('.search-box-result-item')?.classList.add('active');\r\n                        }\r\n                    }\r\n\r\n                    break;\r\n\r\n                case 'ArrowUp':\r\n                    el = this.container.querySelector('.search-box-results.show');\r\n\r\n                    if (el) {\r\n                        let active_item = el.querySelector('.search-box-result-item.active');\r\n\r\n                        if (active_item) {\r\n                            if (active_item.previousElementSibling) {\r\n                                active_item.classList.remove('active');                                \r\n                                active_item = active_item.previousElementSibling;\r\n\r\n                                if (active_item) {\r\n                                    let top = active_item.offsetTop;\r\n \r\n                                    if (top < el.scrollTop) {\r\n                                        el.scrollTop = top; \r\n                                    }\r\n\r\n                                    active_item.classList.add('active'); \r\n                                }\r\n                            }\r\n                        } else {\r\n                            el.classList.remove('show');\r\n                            el.focus();\r\n                        }\r\n                    }\r\n\r\n                    break;\r\n                \r\n                case 'ArrowDown':\r\n                    el = this.container.querySelector('.search-box-results.show');\r\n\r\n                    if (el) {\r\n                        let active_item = el.querySelector('.search-box-result-item.active');\r\n\r\n                        if (active_item) {\r\n                            if (active_item.nextElementSibling) {\r\n                                active_item.classList.remove('active');\r\n                                active_item = active_item.nextElementSibling;\r\n\r\n                                if (active_item) {\r\n                                    let top = active_item.offsetTop;\r\n                                    let item_height = active_item.offsetHeight;\r\n                                    let height = el.offsetHeight;\r\n\r\n\r\n                                    if (top > el.scrollTop + height - 30) {\r\n                                        el.scrollTop = top - (item_height * 6);                                         \r\n                                    }\r\n\r\n                                    active_item.classList.add('active');\r\n                                }\r\n                            }\r\n                        } else {\r\n                            active_item = el.querySelector('.search-box-result-item');\r\n                            active_item.classList.add('active');\r\n\r\n                            let top = active_item.offsetTop;\r\n                            let item_height = active_item.offsetHeight;\r\n\r\n                            el.scrollTop = top - item_height;    \r\n                        }\r\n                    }\r\n\r\n                    break;\r\n\r\n                case 'Enter':\r\n                    el = this.container.querySelector('.search-box-results.show');\r\n\r\n                    if (el) {\r\n                        el.classList.remove('show');\r\n                    }\r\n\r\n                    let active_item = this.container.querySelector('.search-box-result-item.active');\r\n                    let input = evt.target;\r\n\r\n                    if (active_item) {\r\n                        let a = active_item.querySelector('a');\r\n                        let text = a.innerText;\r\n\r\n                        input.value = text;\r\n                        input.focus();\r\n                    }\r\n\r\n                    if (typeof this.handlers['search'] == 'function') {\r\n                        let search_text = input.value.trim();\r\n\r\n                        if (search_text != '') {\r\n                            this.handlers['search'](search_text);\r\n                        }\r\n                    }\r\n\r\n                    break;\r\n            }\r\n        })\r\n    }\r\n\r\n    createResultsContainer() {\r\n        const container = document.createElement('div');\r\n        container.className = 'search-box-results';\r\n        this.inputElement.parentElement.appendChild(container);\r\n        return container;\r\n    }\r\n\r\n    performSearch() {\r\n        const query = this.inputElement.value.toLowerCase();\r\n        this.resultsContainer.innerHTML = '';\r\n\r\n        if (query.length === 0) {\r\n            this.resultsContainer.classList.remove('show');\r\n            return;\r\n        }\r\n\r\n        const filteredItems = this.items.filter(item =>\r\n            item.toLowerCase().includes(query)\r\n        )\r\n\r\n        filteredItems.forEach(item => {\r\n            const resultItem = document.createElement('div');\r\n            resultItem.className = 'search-box-result-item';\r\n            resultItem.innerHTML = `<a href=\"#\">${item}</a>`;\r\n            this.resultsContainer.appendChild(resultItem);\r\n        })\r\n\r\n        this.resultsContainer.classList.add('show');\r\n    }\r\n\r\n    on(evt, handler) {\r\n        this.handlers[evt] = handler;\r\n    }\r\n}"],"names":["wrap","el","wrapper","active_el","SearchBox","inputId","items","evt","current_active","text","_a","search_text","key","active_item","top","item_height","height","input","container","query","item","resultItem","handler"],"mappings":"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"}