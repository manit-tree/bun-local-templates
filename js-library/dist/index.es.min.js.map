{"version":3,"file":"index.es.min.js","sources":["../modules/search-box/index.js"],"sourcesContent":["import './style.css';\r\n\r\nfunction wrap(el, wrapper) {\r\n    el.parentNode.insertBefore(wrapper, el);\r\n    wrapper.appendChild(el);\r\n}\r\n\r\nlet active_el = null;\r\n\r\nexport default class SearchBox {\r\n    constructor(inputId, items) {\r\n        this.handlers = [];\r\n        this.container = document.createElement('div');\r\n        this.container.classList.add('search-box-container');\r\n        this.inputElement = document.getElementById(inputId);\r\n        wrap(this.inputElement, this.container);\r\n        this.items = items;\r\n        this.resultsContainer = this.createResultsContainer();\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        if (!this.inputElement) {\r\n            console.error(`Input element with id ${this.inputElement.id} not found.`);\r\n            return;\r\n        }\r\n\r\n        if (Array.isArray(this.items)) {\r\n            this.items = [...new Set(this.items)];\r\n            this.items.sort();\r\n        }\r\n\r\n        this.container.querySelector('.search-box-results').addEventListener('mousemove', evt => {\r\n            let el = document.elementFromPoint(evt.clientX, evt.clientY);\r\n\r\n            if (el.matches('.search-box-result-item') && (el !== active_el)) {\r\n                let current_active = el.parentElement.querySelector('.active');\r\n\r\n                if (current_active) {\r\n                    current_active.classList.remove('active');\r\n                }\r\n\r\n                active_el = el;\r\n                active_el.classList.add('active');\r\n            }\r\n        })\r\n\r\n        this.container.addEventListener('click', evt => {\r\n            let el = evt.target;\r\n\r\n            if (el.matches('.search-box-result-item')) {\r\n                evt.preventDefault();\r\n\r\n                let a = el.querySelector('a');\r\n                let text = a.innerText;\r\n\r\n                this.container.querySelector('.search-box-results')?.classList.remove('show');\r\n                this.inputElement.value = text;\r\n\r\n                if (typeof this.handlers['search'] == 'function') {\r\n                    let search_text = this.inputElement.value.trim();\r\n\r\n                    if (search_text != '') {\r\n                        this.handlers['search'](search_text);\r\n                    }\r\n                }\r\n            }\r\n        })\r\n\r\n        this.inputElement.addEventListener('input', (evt) => {\r\n            this.performSearch()\r\n        })\r\n\r\n        this.inputElement.addEventListener('keydown', (evt) => {\r\n            let key = evt.key;\r\n            let el;\r\n\r\n            switch (key) {\r\n                case 'Tab':\r\n                    evt.preventDefault();\r\n                    el = this.container.querySelector('.search-box-results.show');\r\n\r\n                    if (el) {\r\n                        let active_item = el.querySelector('.search-box-result-item.active');\r\n\r\n                        if (!active_item) {\r\n                            el.querySelector('.search-box-result-item')?.classList.add('active');\r\n                        }\r\n                    }\r\n\r\n                    break;\r\n\r\n                case 'ArrowUp':\r\n                    el = this.container.querySelector('.search-box-results.show');\r\n\r\n                    if (el) {\r\n                        let active_item = el.querySelector('.search-box-result-item.active');\r\n\r\n                        if (active_item) {\r\n                            if (active_item.previousElementSibling) {\r\n                                active_item.classList.remove('active');                                \r\n                                active_item = active_item.previousElementSibling;\r\n\r\n                                if (active_item) {\r\n                                    let top = active_item.offsetTop;\r\n \r\n                                    if (top < el.scrollTop) {\r\n                                        el.scrollTop = top; \r\n                                    }\r\n\r\n                                    active_item.classList.add('active'); \r\n                                }\r\n                            }\r\n                        } else {\r\n                            el.classList.remove('show');\r\n                            el.focus();\r\n                        }\r\n                    }\r\n\r\n                    break;\r\n                \r\n                case 'ArrowDown':\r\n                    el = this.container.querySelector('.search-box-results.show');\r\n\r\n                    if (el) {\r\n                        let active_item = el.querySelector('.search-box-result-item.active');\r\n\r\n                        if (active_item) {\r\n                            if (active_item.nextElementSibling) {\r\n                                active_item.classList.remove('active');\r\n                                active_item = active_item.nextElementSibling;\r\n\r\n                                if (active_item) {\r\n                                    let top = active_item.offsetTop;\r\n                                    let item_height = active_item.offsetHeight;\r\n                                    let height = el.offsetHeight;\r\n\r\n\r\n                                    if (top > el.scrollTop + height - 30) {\r\n                                        el.scrollTop = top - (item_height * 6);                                         \r\n                                    }\r\n\r\n                                    active_item.classList.add('active');\r\n                                }\r\n                            }\r\n                        } else {\r\n                            active_item = el.querySelector('.search-box-result-item');\r\n                            active_item.classList.add('active');\r\n\r\n                            let top = active_item.offsetTop;\r\n                            let item_height = active_item.offsetHeight;\r\n\r\n                            el.scrollTop = top - item_height;    \r\n                        }\r\n                    }\r\n\r\n                    break;\r\n\r\n                case 'Enter':\r\n                    el = this.container.querySelector('.search-box-results.show');\r\n\r\n                    if (el) {\r\n                        el.classList.remove('show');\r\n                    }\r\n\r\n                    let active_item = this.container.querySelector('.search-box-result-item.active');\r\n                    let input = evt.target;\r\n\r\n                    if (active_item) {\r\n                        let a = active_item.querySelector('a');\r\n                        let text = a.innerText;\r\n\r\n                        input.value = text;\r\n                        input.focus();\r\n                    }\r\n\r\n                    if (typeof this.handlers['search'] == 'function') {\r\n                        let search_text = input.value.trim();\r\n\r\n                        if (search_text != '') {\r\n                            this.handlers['search'](search_text);\r\n                        }\r\n                    }\r\n\r\n                    break;\r\n            }\r\n        })\r\n    }\r\n\r\n    createResultsContainer() {\r\n        const container = document.createElement('div');\r\n        container.className = 'search-box-results';\r\n        this.inputElement.parentElement.appendChild(container);\r\n        return container;\r\n    }\r\n\r\n    performSearch() {\r\n        const query = this.inputElement.value.toLowerCase();\r\n        this.resultsContainer.innerHTML = '';\r\n\r\n        if (query.length === 0) {\r\n            this.resultsContainer.classList.remove('show');\r\n            return;\r\n        }\r\n\r\n        const filteredItems = this.items.filter(item =>\r\n            item.toLowerCase().includes(query)\r\n        )\r\n\r\n        filteredItems.forEach(item => {\r\n            const resultItem = document.createElement('div');\r\n            resultItem.className = 'search-box-result-item';\r\n            resultItem.innerHTML = `<a href=\"#\">${item}</a>`;\r\n            this.resultsContainer.appendChild(resultItem);\r\n        })\r\n\r\n        this.resultsContainer.classList.add('show');\r\n    }\r\n\r\n    on(evt, handler) {\r\n        this.handlers[evt] = handler;\r\n    }\r\n}"],"names":["wrap","el","wrapper","active_el","SearchBox","inputId","items","evt","current_active","_a","text","search_text","key","active_item","top","item_height","height","input","container","query","item","resultItem","handler"],"mappings":"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"}